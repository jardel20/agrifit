<!DOCTYPE html><html><head><title>R: Ajusta o Modelo Linear Descontínuo (LRP)</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script>
const macros = { "\\R": "\\textsf{R}", "\\mbox": "\\text", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R.css">
</head><body><div class="container"><main>

<table style="width: 100%;"><tr><td>ajustar_lrp {agrifit}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Ajusta o Modelo Linear Descontínuo (LRP)</h2>

<h3>Description</h3>

<p>Implementa o ajuste iterativo do modelo Linear Response Plateau (LRP), testando
cada ponto de dose como potencial breakpoint e selecionando o modelo com maior R².
O LRP combina um segmento linear (<code class="reqn">\hat{Y} = b_0 + b_1 X</code>) com plateau
(<code class="reqn">\hat{Y} = b_2</code>), onde <code class="reqn">X_i = (b_2 - b_0) / b_1</code> define a transição.
</p>
<p>Implementa o ajuste iterativo do modelo Linear Response Plateau (LRP), testando
cada ponto de dose como potencial breakpoint e selecionando o modelo com maior R².
O LRP combina um segmento linear (<code class="reqn">\hat{Y} = b_0 + b_1 X</code>) com plateau
(<code class="reqn">\hat{Y} = b_2</code>), onde <code class="reqn">X_i = (b_2 - b_0) / b_1</code> define a transição.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ajustar_lrp(
  dose,
  ...,
  title = "Ajuste do Modelo Linear Descontínuo (LRP)",
  xlab = "Dose",
  ylab = "Resposta",
  adjustment_color = "Set1",
  legend_position_ggplot = "top",
  dashed = FALSE,
  show_intersection = TRUE,
  verbose = TRUE
)

ajustar_lrp(
  dose,
  ...,
  title = "Ajuste do Modelo Linear Descontínuo (LRP)",
  xlab = "Dose",
  ylab = "Resposta",
  adjustment_color = "Set1",
  legend_position_ggplot = "top",
  dashed = FALSE,
  show_intersection = TRUE,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dose">dose</code></td>
<td>
<p>Vetor numérico com níveis do fator (X). Mínimo 4 pontos distintos.</p>
</td></tr>
<tr><td><code id="...">...</code></td>
<td>
<p>Uma ou mais respostas (vetores Y nomeados). Exemplo: <code>MS = materia_seca</code>.</p>
</td></tr>
<tr><td><code id="title">title</code></td>
<td>
<p>Título do gráfico (padrão: &quot;Ajuste do Modelo Linear Descontínuo (LRP)&quot;).</p>
</td></tr>
<tr><td><code id="xlab">xlab</code></td>
<td>
<p>Rótulo eixo X (padrão: &quot;Dose&quot;).</p>
</td></tr>
<tr><td><code id="ylab">ylab</code></td>
<td>
<p>Rótulo eixo Y (padrão: &quot;Resposta&quot;).</p>
</td></tr>
<tr><td><code id="adjustment_color">adjustment_color</code></td>
<td>
<p>Paleta RColorBrewer para curvas (padrão: &quot;Set1&quot;).</p>
</td></tr>
<tr><td><code id="legend_position_ggplot">legend_position_ggplot</code></td>
<td>
<p>Posição da legenda no ggplot (padrão: &quot;top&quot;).</p>
</td></tr>
<tr><td><code id="dashed">dashed</code></td>
<td>
<p>Lógico. Se TRUE, adiciona linhas tracejadas nos breakpoints (padrão: FALSE).</p>
</td></tr>
<tr><td><code id="show_intersection">show_intersection</code></td>
<td>
<p>Lógico. Mostra ponto de intersecção (X) no gráfico (padrão: TRUE).</p>
</td></tr>
<tr><td><code id="verbose">verbose</code></td>
<td>
<p>Lógico. Gera gráficos e prints detalhados (padrão: TRUE).</p>
</td></tr>
</table>


<h3>Details</h3>

<p><strong>Atualizações:</strong> Inclui cálculo de AIC, BIC, RMSE e testes de significância
para os parâmetros do segmento linear (<code class="reqn">b_0</code> e <code class="reqn">b_1</code>).
</p>
<p><strong>Algoritmo iterativo:</strong>
</p>

<ol>
<li><p> Testa breakpoints de 3 até n-1
</p>
</li>
<li><p> Regressão linear pré-breakpoint (<code>lm</code>)
</p>
</li>
<li><p> Média pós-breakpoint como plateau (b2)
</p>
</li>
<li><p> Calcula Xi, R², AIC, BIC, RMSE total
</p>
</li>
<li><p> Seleciona melhor R²
</p>
</li></ol>

<p><strong>Saídas gráficas</strong> (verbose=TRUE):
</p>

<ul>
<li><p> Pontos observados + curvas ajustadas
</p>
</li>
<li><p> Ponto de intersecção opcional (X)
</p>
</li>
<li><p> Linhas tracejadas opcionais (breakpoint)
</p>
</li>
<li><p> Salva &quot;lrp_multiplo.png&quot; (12x8in, 300dpi)
</p>
</li></ul>

<p><strong>Dependências:</strong> <code>ggplot2</code>, <code>plotly</code>, <code>dplyr</code>, <code>tidyr</code>
</p>
<p><strong>Algoritmo iterativo:</strong>
</p>

<ol>
<li><p> Testa breakpoints de 3 até n-1
</p>
</li>
<li><p> Regressão linear pré-breakpoint (<code>lm</code>)
</p>
</li>
<li><p> Média pós-breakpoint como plateau (b2)
</p>
</li>
<li><p> Calcula Xi e R² total
</p>
</li>
<li><p> Seleciona melhor R²
</p>
</li></ol>

<p><strong>Saídas gráficas</strong> (verbose=TRUE):
</p>

<ul>
<li><p> Pontos observados + curvas ajustadas
</p>
</li>
<li><p> Ponto de intersecção opcional (X)
</p>
</li>
<li><p> Linhas tracejadas opcionais (breakpoint)
</p>
</li>
<li><p> Salva &quot;lrp_multiplo.png&quot; (12x8in, 300dpi)
</p>
</li></ul>

<p><strong>Dependências:</strong> <code>ggplot2</code>, <code>plotly</code>, <code>dplyr</code>, <code>tidyr</code>
</p>


<h3>Value</h3>

<p>Lista com:
</p>

<dl>
<dt>resultados</dt><dd><p>Data frame: b0, b1, b2, Xi, R², AIC, BIC, RMSE, p-valores, etc. para cada resposta.</p>
</dd>
<dt>modelos</dt><dd><p>Lista dos melhores modelos por resposta.</p>
</dd>
<dt>equacoes</dt><dd><p>Strings formatadas das equações LRP.</p>
</dd>
<dt>nomes_respostas</dt><dd><p>Nomes das respostas processadas.</p>
</dd>
<dt>grafico_ggplot</dt><dd><p>Gráfico ggplot2 (se verbose=TRUE).</p>
</dd>
<dt>grafico_plotly</dt><dd><p>Gráfico plotly interativo (se verbose=TRUE).</p>
</dd>
</dl>

<p>Lista com:
</p>

<dl>
<dt>resultados</dt><dd><p>Data frame: b0, b1, b2, Xi, R², breakpoint para cada resposta.</p>
</dd>
<dt>modelos</dt><dd><p>Lista dos melhores modelos por resposta.</p>
</dd>
<dt>equacoes</dt><dd><p>Strings formatadas das equações LRP.</p>
</dd>
<dt>nomes_respostas</dt><dd><p>Nomes das respostas processadas.</p>
</dd>
<dt>grafico_ggplot</dt><dd><p>Gráfico ggplot2 (se verbose=TRUE).</p>
</dd>
<dt>grafico_plotly</dt><dd><p>Gráfico plotly interativo (se verbose=TRUE).</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
dose_P &lt;- c(0.0, 32.5, 65.0, 97.5, 130.0, 195.0, 260.0, 325.0)
MS &lt;- c(6.74, 8.73, 10.89, 12.56, 14.11, 15.21, 15.50, 15.60)

res &lt;- ajustar_lrp(
  dose = dose_P, MS = MS,
  title = "Matéria Seca vs Dose de P",
  xlab = "P (mg/dm³)", ylab = "MS (g/vaso)",
  adjustment_color = "Dark2"
)

print(res$resultados)
print(res$equacoes)

## End(Not run)
## Not run: 
dose_P &lt;- c(0.0, 32.5, 65.0, 97.5, 130.0, 195.0)
MS &lt;- c(6.74, 8.73, 10.89, 12.56, 14.11, 15.21)

res &lt;- ajustar_lrp(
  dose = dose_P, MS = MS,
  title = "Matéria Seca vs Dose de P",
  xlab = "P (mg/dm³)", ylab = "MS (g/vaso)",
  adjustment_color = "Dark2"
)

print(res$resultados)
print(res$equacoes)

## End(Not run)
</code></pre>

<hr><div style="text-align: center;">[Package <em>agrifit</em> version 0.1.0 <a href="00Index.html">Index</a>]</div></main>

</div>
</body></html>
