% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/ajustar_lrp_atualizada.R, R/linear_plateau.R
\name{ajustar_lrp}
\alias{ajustar_lrp}
\title{Ajusta o Modelo Linear Descontínuo (LRP)}
\usage{
ajustar_lrp(
  dose,
  ...,
  title = "Ajuste do Modelo Linear Descontínuo (LRP)",
  xlab = "Dose",
  ylab = "Resposta",
  adjustment_color = "Set1",
  legend_position_ggplot = "top",
  dashed = FALSE,
  show_intersection = TRUE,
  verbose = TRUE
)

ajustar_lrp(
  dose,
  ...,
  title = "Ajuste do Modelo Linear Descontínuo (LRP)",
  xlab = "Dose",
  ylab = "Resposta",
  adjustment_color = "Set1",
  legend_position_ggplot = "top",
  dashed = FALSE,
  show_intersection = TRUE,
  verbose = TRUE
)
}
\arguments{
\item{dose}{Vetor numérico com níveis do fator (X). Mínimo 4 pontos distintos.}

\item{...}{Uma ou mais respostas (vetores Y nomeados). Exemplo: \code{MS = materia_seca}.}

\item{title}{Título do gráfico (padrão: "Ajuste do Modelo Linear Descontínuo (LRP)").}

\item{xlab}{Rótulo eixo X (padrão: "Dose").}

\item{ylab}{Rótulo eixo Y (padrão: "Resposta").}

\item{adjustment_color}{Paleta RColorBrewer para curvas (padrão: "Set1").}

\item{legend_position_ggplot}{Posição da legenda no ggplot (padrão: "top").}

\item{dashed}{Lógico. Se TRUE, adiciona linhas tracejadas nos breakpoints (padrão: FALSE).}

\item{show_intersection}{Lógico. Mostra ponto de intersecção (X) no gráfico (padrão: TRUE).}

\item{verbose}{Lógico. Gera gráficos e prints detalhados (padrão: TRUE).}
}
\value{
Lista com:
\describe{
\item{resultados}{Data frame: b0, b1, b2, Xi, R², AIC, BIC, RMSE, p-valores, etc. para cada resposta.}
\item{modelos}{Lista dos melhores modelos por resposta.}
\item{equacoes}{Strings formatadas das equações LRP.}
\item{nomes_respostas}{Nomes das respostas processadas.}
\item{grafico_ggplot}{Gráfico ggplot2 (se verbose=TRUE).}
\item{grafico_plotly}{Gráfico plotly interativo (se verbose=TRUE).}
}

Lista com:
\describe{
\item{resultados}{Data frame: b0, b1, b2, Xi, R², breakpoint para cada resposta.}
\item{modelos}{Lista dos melhores modelos por resposta.}
\item{equacoes}{Strings formatadas das equações LRP.}
\item{nomes_respostas}{Nomes das respostas processadas.}
\item{grafico_ggplot}{Gráfico ggplot2 (se verbose=TRUE).}
\item{grafico_plotly}{Gráfico plotly interativo (se verbose=TRUE).}
}
}
\description{
Implementa o ajuste iterativo do modelo Linear Response Plateau (LRP), testando
cada ponto de dose como potencial breakpoint e selecionando o modelo com maior R².
O LRP combina um segmento linear (\eqn{\hat{Y} = b_0 + b_1 X}) com plateau
(\eqn{\hat{Y} = b_2}), onde \eqn{X_i = (b_2 - b_0) / b_1} define a transição.

Implementa o ajuste iterativo do modelo Linear Response Plateau (LRP), testando
cada ponto de dose como potencial breakpoint e selecionando o modelo com maior R².
O LRP combina um segmento linear (\eqn{\hat{Y} = b_0 + b_1 X}) com plateau
(\eqn{\hat{Y} = b_2}), onde \eqn{X_i = (b_2 - b_0) / b_1} define a transição.
}
\details{
\strong{Atualizações:} Inclui cálculo de AIC, BIC, RMSE e testes de significância
para os parâmetros do segmento linear (\eqn{b_0} e \eqn{b_1}).

\strong{Algoritmo iterativo:}
\enumerate{
\item Testa breakpoints de 3 até n-1
\item Regressão linear pré-breakpoint (\code{lm})
\item Média pós-breakpoint como plateau (b2)
\item Calcula Xi, R², AIC, BIC, RMSE total
\item Seleciona melhor R²
}

\strong{Saídas gráficas} (verbose=TRUE):
\itemize{
\item Pontos observados + curvas ajustadas
\item Ponto de intersecção opcional (X)
\item Linhas tracejadas opcionais (breakpoint)
\item Salva "lrp_multiplo.png" (12x8in, 300dpi)
}

\strong{Dependências:} \code{ggplot2}, \code{plotly}, \code{dplyr}, \code{tidyr}

\strong{Algoritmo iterativo:}
\enumerate{
\item Testa breakpoints de 3 até n-1
\item Regressão linear pré-breakpoint (\code{lm})
\item Média pós-breakpoint como plateau (b2)
\item Calcula Xi e R² total
\item Seleciona melhor R²
}

\strong{Saídas gráficas} (verbose=TRUE):
\itemize{
\item Pontos observados + curvas ajustadas
\item Ponto de intersecção opcional (X)
\item Linhas tracejadas opcionais (breakpoint)
\item Salva "lrp_multiplo.png" (12x8in, 300dpi)
}

\strong{Dependências:} \code{ggplot2}, \code{plotly}, \code{dplyr}, \code{tidyr}
}
\examples{
\dontrun{
dose_P <- c(0.0, 32.5, 65.0, 97.5, 130.0, 195.0, 260.0, 325.0)
MS <- c(6.74, 8.73, 10.89, 12.56, 14.11, 15.21, 15.50, 15.60)

res <- ajustar_lrp(
  dose = dose_P, MS = MS,
  title = "Matéria Seca vs Dose de P",
  xlab = "P (mg/dm³)", ylab = "MS (g/vaso)",
  adjustment_color = "Dark2"
)

print(res$resultados)
print(res$equacoes)
}
\dontrun{
dose_P <- c(0.0, 32.5, 65.0, 97.5, 130.0, 195.0)
MS <- c(6.74, 8.73, 10.89, 12.56, 14.11, 15.21)

res <- ajustar_lrp(
  dose = dose_P, MS = MS,
  title = "Matéria Seca vs Dose de P",
  xlab = "P (mg/dm³)", ylab = "MS (g/vaso)",
  adjustment_color = "Dark2"
)

print(res$resultados)
print(res$equacoes)
}
}
